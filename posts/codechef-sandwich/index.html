<!DOCTYPE html>
<html lang="en">
<head>
  
    <title>Long Sandwich - Codechef SANDWICH :: MathBugs</title>
  
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="It has two parts to this problem. You are given $n$ and $k$. You have to tell the minimum number of pieces, $a$, you can cut a sandwich of length $n$ such that the length of no piece is greater than $k$.
The answer is quite simple, isn&amp;rsquo;t it ?
Answer of the first part  click to hide  $a = \lceil \frac{n}{k} \rceil$    The second part is, how many ways we can cut the sandwich into $a$ pieces such that the length of no piece is greater than $k$." />
<meta name="keywords" content=", " />
<meta name="robots" content="noodp" />
<link rel="canonical" href="https://st3inum.github.io/posts/codechef-sandwich/" />




<script src="//cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.slim.min.js"></script>

<script type="text/x-mathjax-config">MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}});</script>
    <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>


<link rel="stylesheet" href="https://st3inum.github.io/assets/style.css">






<link rel="apple-touch-icon" href="https://st3inum.github.io/img/apple-touch-icon-192x192.png">

  <link rel="shortcut icon" href="https://st3inum.github.io/img/favicon/orange.png">



<meta name="twitter:card" content="summary" />

  
    <meta name="twitter:site" content="" />
  
    <meta name="twitter:creator" content="" />



<meta property="og:locale" content="en" />
<meta property="og:type" content="article" />
<meta property="og:title" content="Long Sandwich - Codechef SANDWICH">
<meta property="og:description" content="It has two parts to this problem. You are given $n$ and $k$. You have to tell the minimum number of pieces, $a$, you can cut a sandwich of length $n$ such that the length of no piece is greater than $k$.
The answer is quite simple, isn&amp;rsquo;t it ?
Answer of the first part  click to hide  $a = \lceil \frac{n}{k} \rceil$    The second part is, how many ways we can cut the sandwich into $a$ pieces such that the length of no piece is greater than $k$." />
<meta property="og:url" content="https://st3inum.github.io/posts/codechef-sandwich/" />
<meta property="og:site_name" content="MathBugs" />

  <meta property="og:image" content="https://st3inum.github.io/">

<meta property="og:image:width" content="2048">
<meta property="og:image:height" content="1024">


  <meta property="article:published_time" content="2021-04-30 22:03:31 &#43;0600 &#43;06" />












</head>
<body class="orange">


<div class="container full headings--one-size">

  <header class="header">
  <div class="header__inner">
    <div class="header__logo">
      <a href="/">
  <div class="logo">
    MathBugs
  </div>
</a>

    </div>
    
      <div class="menu-trigger">menu</div>
    
  </div>
  
    <nav class="menu">
  <ul class="menu__inner menu__inner--desktop">
    
      
        
          <li><a href="/about">About</a></li>
        
      
        
          <li><a href="/posts">Post</a></li>
        
      
      
    

    
  </ul>

  <ul class="menu__inner menu__inner--mobile">
    
      
        <li><a href="/about">About</a></li>
      
    
      
        <li><a href="/posts">Post</a></li>
      
    
    
  </ul>
</nav>

  
</header>


  <div class="content">
    
<div class="post">
  <h1 class="post-title">
    <a href="https://st3inum.github.io/posts/codechef-sandwich/">Long Sandwich - Codechef SANDWICH</a></h1>
  <div class="post-meta">
    
      <span class="post-date">
        2021-04-30 
      </span>
    
    
    <span class="post-author">:: steinum</span>
    
  </div>

  
  <span class="post-tags">
    
    #<a href="https://st3inum.github.io/tags/combinatorics/">combinatorics</a>&nbsp;
    
    #<a href="https://st3inum.github.io/tags/crt/">crt</a>&nbsp;
    
    #<a href="https://st3inum.github.io/tags/lucas-theorem/">lucas theorem</a>&nbsp;
    
    #<a href="https://st3inum.github.io/tags/number-theory/">number theory</a>&nbsp;
    
    #<a href="https://st3inum.github.io/tags/legendres-formula/">legendre&#39;s formula</a>&nbsp;
    
    #<a href="https://st3inum.github.io/tags/counting/">counting</a>&nbsp;
    
    #<a href="https://st3inum.github.io/tags/codechef/">codechef</a>&nbsp;
    
  </span>
  

  

  

  <div class="post-content"><div>
        <p>It has two parts to this problem. You are given $n$ and $k$. You have to tell the minimum number of pieces, $a$, you can cut a sandwich of length $n$ such that the length of no piece is greater than $k$.</p>
<p>The answer is quite simple, isn&rsquo;t it ?</p>

<div class="spoiler panel panel-default">
<div class='spoiler_block'>
      
        
      
<a href='#' class='spoiler-block-icon spoiler-block-icon-zoom-in spoiler_block_show'>
Answer of the first part
</a>

<a href='#' class='spoiler-block-icon spoiler-block-icon-zoom-out spoiler_block_hide' style='display: none;'>
click to hide
</a>

<div class='spoiler_block_content' style='display: none;'>
$a = \lceil \frac{n}{k} \rceil$
</div>
</div>
</div>

<p>The second part is, how many ways we can cut the sandwich into $a$ pieces such that the length of no piece is greater than $k$. You have print the answer under modulo $m$, for a given $m$.</p>

<div class="spoiler panel panel-default">
<div class='spoiler_block'>
      
        
      
<a href='#' class='spoiler-block-icon spoiler-block-icon-zoom-in spoiler_block_show'>
Hint for the second part
</a>

<a href='#' class='spoiler-block-icon spoiler-block-icon-zoom-out spoiler_block_hide' style='display: none;'>
click to hide
</a>

<div class='spoiler_block_content' style='display: none;'>
<code>Stars and Bars Theorem</code>
</div>
</div>
</div>

<h2 id="inside-math">Inside Math:<a href="#inside-math" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h2>
<p>Suppose, we have exactly $ak$ length of sandwich. How many ways are there to cut the sandwich ? Answer : 1.</p>
<p>Now, we have some $extra = ak-n$ length of sandwich , which we have to subtract.</p>
<p>Now, the problem turns into: <strong>how many ways we can cut a sandwich of length, $extra$, into $a$ pieces.</strong> [Because if in one way we can cut $p$ length of sandwich for the $i$&lsquo;th piece, we can actually subtract $p$ from the $i$&lsquo;th piece in the previous solution].</p>
<p>Hence, our solution is $\binom{extra + a - 1}{a - 1}$ [Directly from stars and bars theorem].</p>
<h2 id="subtask-1">Subtask 1:<a href="#subtask-1" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h2>
<ul>
<li>$1\le n,k \le 50$</li>
<li>$2 \le m \le 10^{6}$</li>
</ul>
<p>We can directly calculate our solution with dp.</p>



  <div class="collapsable-code">
    <input id="1" type="checkbox"  />
    <label for="1">
      <span class="collapsable-code__language">cpp</span>
      <span class="collapsable-code__title">Long Sandwich: subtask 1</span>
      <span class="collapsable-code__toggle" data-label-expand="Show" data-label-collapse="Hide"></span>
    </label>
    <pre class="language-cpp" ><code id="code1">
</code></pre>
  </div>


<script type="text/javascript">
  var xmlHttp = new XMLHttpRequest();
    xmlHttp.open( "GET", 'https:\/\/raw.githubusercontent.com\/st3inum\/blog\/master\/codes\/codechef\/SANDWICH_1.cpp', false ); 
    xmlHttp.send( null );
    var div = document.getElementById('code1');
    div.textContent = '\n'+xmlHttp.responseText;
    
    
</script>


<h2 id="subtask-3">Subtask 3:<a href="#subtask-3" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h2>
<ul>
<li>$1\le n,k \le 10^{18}$</li>
<li>$2 \le m \le 10^{6}$ and $m$ is a prime number.</li>
</ul>
<p>In this case we can calculate the value of $\binom{n}{r}$ with lucas theorem.</p>



  <div class="collapsable-code">
    <input id="3" type="checkbox"  />
    <label for="3">
      <span class="collapsable-code__language">cpp</span>
      <span class="collapsable-code__title">Long Sandwich: subtask 3</span>
      <span class="collapsable-code__toggle" data-label-expand="Show" data-label-collapse="Hide"></span>
    </label>
    <pre class="language-cpp" ><code id="code3">
</code></pre>
  </div>


<script type="text/javascript">
  var xmlHttp = new XMLHttpRequest();
    xmlHttp.open( "GET", 'https:\/\/raw.githubusercontent.com\/st3inum\/blog\/master\/codes\/codechef\/SANDWICH_3.cpp', false ); 
    xmlHttp.send( null );
    var div = document.getElementById('code3');
    div.textContent = '\n'+xmlHttp.responseText;
    
    
</script>


<h2 id="subtask-4">Subtask 4:<a href="#subtask-4" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h2>
<ul>
<li>$1\le n,k \le 10^{18}$</li>
<li>$2 \le m \le 10^{6}$</li>
</ul>
<p>In this case, at first, we will calculate $\binom{n}{r}$ modulo prime power. Then merge them up with <code>CRT</code> and get the value of $\binom{n}{r}$ modulo an arbitrary number.</p>
<p>To calculate $\binom{n}{r}$ (mod $p^{k}$) [$p$ is a prime number and $k&gt;0$], we will calculate $n!$ (mod $p^{k}$) , but ignoring all occurrences of $p$.</p>
<p>Now let&rsquo;s define some function/variables.</p>
<ul>
<li>$F_{n} = \prod_{i = 1 , p\nmid i}^{n}{i}$ (mod $p^{k}$)</li>
<li>$L(n) = $ max $k$ such that $p^k \mid n!$ [with Legendre&rsquo;s Formula]</li>
<li>$f(n)$ = $\frac{n!}{p^{L(n)}}$ (mod $p^{k}$)</li>
</ul>
<h3 id="calculate-ln">Calculate $L(n)$:<a href="#calculate-ln" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h3>
<p>$L(n) = \sum_{i=1}^{\infty}{\lfloor \frac{n}{p^{i}} \rfloor}$ [known as Legendre&rsquo;s Formula]</p>
<h3 id="calculate-fn">Calculate $f(n)$:<a href="#calculate-fn" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h3>
<p>$ f(n) = \begin{cases} 1 \text{ , if $n=0$} \newline F_{p^{e}}^{\lfloor \frac{n}{p^e} \rfloor} \times F_{n \text{ (mod $p^e$)}} \times f(\lfloor \frac{n}{p} \rfloor) \text{ , if $n \neq 0$} \end{cases}$</p>
<h3 id="calculate-binomnr">Calculate $\binom{n}{r}$:<a href="#calculate-binomnr" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h3>
<p>$\binom{n}{r} = \frac{f(n)}{f(r)\times f(n-r)} \times p^{L(n)-L(r)-L(n-r)}$</p>
<p>Now, the remaining part is to merge all answer from $p^k$ [$p^k\mid m$ and $p^{k+1}\nmid m$] with <code>CRT</code> .</p>



  <div class="collapsable-code">
    <input id="4" type="checkbox"  />
    <label for="4">
      <span class="collapsable-code__language">cpp</span>
      <span class="collapsable-code__title">Long Sandwich: subtask 4</span>
      <span class="collapsable-code__toggle" data-label-expand="Show" data-label-collapse="Hide"></span>
    </label>
    <pre class="language-cpp" ><code id="code4">
</code></pre>
  </div>


<script type="text/javascript">
  var xmlHttp = new XMLHttpRequest();
    xmlHttp.open( "GET", 'https:\/\/raw.githubusercontent.com\/st3inum\/blog\/master\/codes\/codechef\/SANDWICH_4.cpp', false ); 
    xmlHttp.send( null );
    var div = document.getElementById('code4');
    div.textContent = '\n'+xmlHttp.responseText;
    
    
</script>


<h2 id="reference">Reference:<a href="#reference" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h2>
<ul>
<li><a href="https://www.codechef.com/problems/SANDWICH">Codechef - SANDWICH</a></li>
<li><a href="https://forthright48.com/stars-and-bars-theorem">Stars and Bars Theorem</a></li>
<li><a href="https://forthright48.com/chinese-remainder-theorem-part-1-coprime-moduli/">CRT - Chinese Remainder Theorem</a></li>
<li><a href="https://brilliant.org/wiki/lucas-theorem/">Lucas&rsquo; Theorem</a></li>
<li><a href="https://en.wikipedia.org/wiki/Legendre%27s_formula">Legendre&rsquo;s Formula</a></li>
<li><a href="https://cp-algorithms.com/combinatorics/binomial-coefficients.html">Emaxx : Binomial Coefficients</a></li>
</ul>

      </div></div>

  
  
<div class="pagination">
    <div class="pagination__title">
        <span class="pagination__title-h">Read other posts</span>
        <hr />
    </div>
    <div class="pagination__buttons">
        
        
        <span class="button next">
            <a href="https://st3inum.github.io/posts/uva-11029/">
                <span class="button__text">Leading and Trailing - UVA 11029</span>
                <span class="button__icon">→</span>
            </a>
        </span>
        
    </div>
</div>

  

  

</div>

  </div>

  
    <footer class="footer">
  <div class="footer__inner">
    
      <div class="copyright">
        <span>© 2021 Powered by <a href="http://gohugo.io">Hugo</a></span>
    
        <span>:: Theme made by <a href="https://twitter.com/panr">panr</a></span>
      </div>
  </div>
</footer>





<script src="https://st3inum.github.io/assets/spoiler.js"></script>
<script src="https://st3inum.github.io/assets/spoiler.css"></script>


<script src="https://st3inum.github.io/assets/main.js"></script>

<script src="https://st3inum.github.io/assets/prism.js"></script>













  
</div>

</body>
</html>
